<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Training planner</title>
  <style>
    /* Minimalist neon glass dark theme, single-file, no CDN */
    :root{
      --bg-0:#05060a; --bg-1:#071021; --glass:rgba(255,255,255,0.04);
      --neon-1:#00d4ff; --neon-2:#7c5cff; --muted:#9aa0b4; --card:#0b0f16;
      --radius:14px; --glass-strong:rgba(255,255,255,0.06);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,"Segoe UI",Roboto,Arial;color:#e6eef8;background:#121524;-webkit-font-smoothing:antialiased;padding:28px;}



    .shell{max-width:1120px;margin:0 auto}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:20px}
    h1{margin:0;font-size:18px;color:var(--neon-1);text-shadow:0 4px 18px rgba(0,212,255,0.09)}

    /* Tabs */
    .tabs{display:flex;gap:8px}
    .tab{padding:8px 12px;border-radius:12px;background:transparent;border:1px solid transparent;color:var(--muted);cursor:pointer;backdrop-filter:blur(6px);transition:all .28s cubic-bezier(.2,.9,.2,1)}
    .tab:hover{transform:translateY(-3px)}
    .tab.active{background:linear-gradient(90deg,var(--neon-2),var(--neon-1));color:#041022;box-shadow:0 6px 30px rgba(124,92,255,.12),0 2px 8px rgba(0,212,255,.06)}

    /* Layout */
    main{display:block}
    .panel{display:grid;grid-template-columns:1fr 360px;gap:20px}
    @media(max-width:980px){.panel{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:var(--radius);border:1px solid var(--glass);box-shadow:0 6px 30px rgba(2,6,23,0.6)}

    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type="number"],select{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:#07101a;color:#e6eef8}

    .controls-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}

    button.primary{display:inline-block;padding:12px 14px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--neon-2),var(--neon-1));color:#031022;font-weight:700;cursor:pointer;box-shadow:0 6px 30px rgba(124,92,255,.12);transition:transform .12s ease,box-shadow .12s}
    button.primary:active{transform:scale(.985)}

    /* Results */
    #result{margin-top:14px;min-height:40px;overflow:auto}
    .plan-day{padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.03));border-left:6px solid var(--neon-1);margin-bottom:14px;opacity:0;transform:translateY(10px);transition:all .45s cubic-bezier(.2,.9,.2,1)}
    .plan-day.visible{opacity:1;transform:none}
    .exercise{padding:10px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(10,16,22,0.03));margin:8px 0;border:1px solid rgba(255,255,255,0.02);display:flex;justify-content:space-between;gap:12px;align-items:center}
    .ex-left{min-width:0}
    .ex-name{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .ex-meta{font-size:13px;color:var(--muted)}
    .ex-weight{font-weight:800;color:var(--neon-1);text-shadow:0 6px 18px rgba(0,212,255,0.06)}

    .small{font-size:13px;color:var(--muted)}

    /* Timer */
    .timer{display:flex;flex-direction:column;gap:8px}
    .timer-display{font-size:28px;text-align:center;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.03));border-radius:10px}
    .timer-controls{display:flex;gap:8px;flex-wrap:wrap}
    .btn{padding:10px;border-radius:10px;border:1px solid var(--glass);background:transparent;color:var(--neon-1);cursor:pointer;transition:all .12s}
    .btn:active{transform:translateY(1px)}

    /* Recommendations */
    .recommendations{margin-top:12px;padding:12px;border-radius:12px;background:linear-gradient(90deg, rgba(124,92,255,0.02), rgba(0,212,255,0.02));border:1px solid rgba(255,255,255,0.02)}

    /* Micro animations */
    .pulse{animation:pulse 3s infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(0,212,255,0.06)}70%{box-shadow:0 0 0 12px rgba(0,212,255,0)}100%{box-shadow:0 0 0 0 rgba(0,212,255,0)}}

    /* Accessibility helpers */
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* Responsive tweaks */
    @media(max-width:520px){.controls-grid{grid-template-columns:1fr} .panel{gap:12px}}

  </style>
</head>
<body>
  <div class="shell">
    <header>
      <h1>Планування тренувань</h1>
      <div class="tabs" role="tablist">
        <button class="tab active" data-tab="plan" role="tab" aria-selected="true">План</button>
        <button class="tab" data-tab="timer" role="tab" aria-selected="false">Таймер</button>
      </div>
    </header>

    <main>
      <section id="planView" class="panel">
        <div>
          <form id="plannerForm" class="card" autocomplete="off" onsubmit="return false;">
            <div class="controls-grid">
              <div>
                <label for="age">Вік</label>
                <input id="age" name="age" type="number" min="12" max="100" placeholder="25" />
              </div>
              <div>
                <label for="gender">Стать</label>
                <select id="gender" name="gender"><option>Чоловік</option><option>Жінка</option><option>Інше</option></select>
              </div>
            </div>

            <div class="controls-grid" style="margin-top:12px">
              <div>
                <label for="weight">Вага (кг)</label>
                <input id="weight" name="weight" type="number" min="30" max="300" placeholder="75" />
              </div>
              <div>
                <label for="height">Зріст (см)</label>
                <input id="height" name="height" type="number" min="120" max="240" placeholder="180" />
              </div>
            </div>

            <div class="controls-grid" style="margin-top:12px">
              <div>
                <label for="goal">Ціль</label>
                <select id="goal" name="goal"><option>Схуднення</option><option>Набір м'язів</option><option>Підтримка форми</option></select>
              </div>
              <div>
                <label for="level">Рівень</label>
                <select id="level" name="level"><option>Новачок</option><option>Середній</option><option>Просунутий</option></select>
              </div>
            </div>

            <div style="display:flex;gap:12px;align-items:end;margin-top:12px">
              <div style="flex:1">
                <label for="days">Днів (1–30)</label>
                <input id="days" name="days" type="number" min="1" max="30" value="14" />
              </div>
              <div>
                <button id="gen" class="primary" type="button" title="Згенерувати план">Згенерувати</button>
              </div>
            </div>

          </form>

          <div id="result" class="card" style="margin-top:14px">
            <div class="small">План буде показано тут після натискання "Згенерувати".</div>
          </div>
        </div>

        <aside>
          <div class="card">
            <h3 style="margin:6px 0 12px 0">Швидка інформація</h3>
            <div class="small">Робоча вага тепер розраховується за більш реалістичною формулою, з коефіцієнтами для типів вправ, випадковістю ±10% та окремими діапазонами для кардіо/силових.</div>

            <div style="margin-top:12px">
              <strong>Поради</strong>
              <ul class="small">
                <li>Розминка 5–10 хв.</li>
                <li>Контроль техніки в базових вправах.</li>
                <li>Прогресія: +2.5–5% раз на 1–2 тижні.</li>
              </ul>
            </div>

            <div class="recommendations">
              <strong>Рекомендації</strong>
              <ul class="small">
                <li>Сон 7–9 год.</li>
                <li>Пити 2–2.5 л води щоденно.</li>
                <li>Білок 1.6–2.2 г/кг для росту м'язів.</li>
              </ul>
            </div>
          </div>
        </aside>
      </section>

      <section id="timerView" style="display:none">
        <div class="card">
          <h2 style="margin-top:0">Таймер</h2>
          <div style="display:flex;gap:12px;flex-wrap:wrap">
            <div style="flex:1;min-width:260px" class="card">
              <h3 style="margin:0 0 8px 0">Секундомір</h3>
              <div id="stopwatchDisplay" class="timer-display">00:00:00.0</div>
              <div class="timer-controls" style="margin-top:8px">
                <button id="swStart" class="btn">Start</button>
                <button id="swStop" class="btn">Stop</button>
                <button id="swReset" class="btn">Reset</button>
              </div>
            </div>

            <div style="flex:1;min-width:260px" class="card">
              <h3 style="margin:0 0 8px 0">Таймер відліку</h3>
              <label class="small">Встановити секунди</label>
              <input id="countdownInput" type="number" placeholder="Наприклад: 60" />
              <div id="countdownDisplay" class="timer-display">00:00</div>
              <div class="timer-controls" style="margin-top:8px">
                <button id="cdStart" class="btn">Start</button>
                <button id="cdPause" class="btn">Pause</button>
                <button id="cdReset" class="btn">Reset</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

<script>
/* ===== Modular JS: keep global pollution minimal ===== */
(() => {
  'use strict';

  // ---------- Data ----------
  const DB = {
    "Схуднення": [
      [ {name:'Бёрпі', type:'cardio'}, {name:'Гоблет-присідання', type:'compound'}, {name:'Стрибки на тумбу', type:'plyo'}, {name:'Маунтін-клаймер', type:'cardio'}, {name:'Тяга гантелі в нахилі', type:'compound'} ],
      [ {name:'Випади назад', type:'compound'}, {name:'Планка + дотик плечей', type:'core'}, {name:'Румунська тяга', type:'compound'}, {name:'Жим гантелей стоячи', type:'compound'}, {name:'Тяга блоку до грудей', type:'compound'} ],
      [ {name:'Стрибки з розведенням', type:'cardio'}, {name:'Тяга штанги в нахилі', type:'compound'}, {name:'Пуловер', type:'isolation'}, {name:'Стрибкові присідання', type:'plyo'}, {name:'Сайд-планка', type:'core'} ]
    ],
    "Набір м'язів": [
      [ {name:'Жим лежачи', type:'compound'}, {name:'Присідання зі штангою', type:'compound'}, {name:'Тяга штанги в нахилі', type:'compound'}, {name:'Армійський жим', type:'compound'}, {name:'Підйом штанги на біцепс', type:'isolation'} ],
      [ {name:'Жим гантелей на похилій', type:'compound'}, {name:'Тяга вертикального блоку', type:'compound'}, {name:'Французький жим', type:'isolation'}, {name:'Гіперекстензії', type:'isolation'}, {name:'Тяга гантелі до поясу', type:'compound'} ],
      [ {name:'Фронтальні присідання', type:'compound'}, {name:'Тяга сумо', type:'compound'}, {name:'Шраги', type:'isolation'}, {name:'Пуловер', type:'isolation'}, {name:'Згинання ніг лежачи', type:'isolation'} ]
    ],
    "Підтримка форми": [
      [ {name:'Присідання', type:'compound'}, {name:'Тяга гантелей', type:'compound'}, {name:'Віджимання', type:'compound'}, {name:'Планка', type:'core'}, {name:'Жим гантелей сидячи', type:'compound'} ],
      [ {name:'Випади вперед', type:'compound'}, {name:'Горизонтальна тяга', type:'compound'}, {name:'Жим лежачи', type:'compound'}, {name:'Бічна планка', type:'core'}, {name:'Румунська тяга', type:'compound'} ],
      [ {name:'Жим стоячи', type:'compound'}, {name:'Тяга штанги', type:'compound'}, {name:'Тяга блоку', type:'compound'}, {name:'Пуловер', type:'isolation'}, {name:'Скручування', type:'core'} ]
    ]
  };

  // ---------- Helpers & Input sanitization ----------
  function q(id){ return document.getElementById(id); }
  function getInputs(){
    const age = String(q('age').value||'').trim();
    const gender = String(q('gender').value||'').trim();
    const weight = Number(q('weight').value) || 0;
    const height = Number(q('height').value) || 0;
    const goal = String(q('goal').value||'').trim();
    const level = String(q('level').value||'').trim();
    let days = parseInt(q('days').value,10); if(isNaN(days)||days<1) days=1; if(days>30) days=30;
    return {age,gender,weight,height,goal,level,days};
  }

  // ---------- Strength model (improved & explained) ----------
  /*
    New formula approach (more realistic & stable):
    - baseMass ~ weight * 0.8 (accounts that not all bodyweight is muscle)
    - heightFactor ~ (height/180) to reflect leverage
    - baseStrength = baseMass * (0.9 + (heightFactor-1)*0.15)
    - levelCoef: 0.5|0.75|1.0 for novice/medium/advanced to scale capacity
    - typeCoef: different for compound / isolation / core / plyo / cardio
    - finalWorkingWeight = baseStrength * levelCoef * typeCoef * randomFactor
    - randomFactor introduces ±7–10% realism and prevents identical numbers each day

    This produces realistic numbers for intermediate lifters while keeping novice numbers moderate.
  */
  function baseStrength(weight, height){
    if(!weight || !height) return 0;
    const baseMass = weight * 0.8; // kg considered as effective mass
    const heightFactor = height / 180; // normalized
    const base = baseMass * (0.9 + (heightFactor - 1) * 0.15);
    return Math.max(5, base);
  }

  function levelCoef(level){
    if(level==='Новачок') return 0.5;
    if(level==='Середній') return 0.75;
    return 1.0; // Просунутий
  }

  function typeCoef(type){
    switch(type){
      case 'compound': return 1.0;   // main lifts use most of base
      case 'isolation': return 0.45; // single-joint smaller loads
      case 'core': return 0.25;      // core exercises rarely have heavy external load
      case 'plyo': return 0.35;      // explosive / bodyweight biased
      case 'cardio': return null;    // no working weight
      default: return 0.6;
    }
  }

  function randomFactor(){
    // returns number between 0.92 and 1.08
    return 0.92 + Math.random() * 0.16;
  }

  function workingWeightForExercise(weight,height,level,type){
    const base = baseStrength(weight,height);
    if(!base) return null;
    const lvl = levelCoef(level);
    const tcoef = typeCoef(type);
    if(tcoef===null) return null; // cardio
    const raw = base * lvl * tcoef * randomFactor();
    // Round to sensible increments (2.5 kg for larger, 1 kg for small)
    const rounded = raw >= 20 ? Math.round(raw / 2.5) * 2.5 : Math.round(raw);
    return Math.max(1, rounded);
  }

  // ---------- Plan generation ----------
  function generateExercises(goal, day){
    if(!DB[goal]) return [];
    const variants = DB[goal];
    const idx = (day - 1) % variants.length;
    return variants[idx].map(e => ({...e})); // shallow copy
  }

  // Render with animations and improved html structure
  function renderPlan(){
    const {age,gender,weight,height,goal,level,days} = getInputs();
    const container = q('result');
    container.innerHTML = '';

    // Header
    const header = document.createElement('div');
    header.className = 'small';
    header.textContent = `Параметри: вік ${age||'—'}, стать ${gender||'—'}, вага ${weight||'—'} кг, зріст ${height||'—'} см. Ціль: ${goal}. Рівень: ${level}. Днів: ${days}.`;
    container.appendChild(header);

    const hr = document.createElement('hr'); hr.style.border='0'; hr.style.borderTop='1px solid rgba(255,255,255,0.04)'; hr.style.margin='12px 0'; container.appendChild(hr);

    // generate day blocks
    for(let d=1; d<=days; d++){
      const dayBlock = document.createElement('div'); dayBlock.className='plan-day';
      dayBlock.innerHTML = `<strong>День ${d}</strong><div style="margin-top:8px"></div>`;
      const inner = dayBlock.querySelector('div');

      const exercises = generateExercises(goal,d);
      exercises.forEach(ex => {
        const w = workingWeightForExercise(weight,height,level,ex.type);
        const exEl = document.createElement('div'); exEl.className='exercise';
        const left = document.createElement('div'); left.className='ex-left';
        const name = document.createElement('div'); name.className='ex-name'; name.textContent = ex.name;
        const meta = document.createElement('div'); meta.className='ex-meta'; meta.textContent = `Тип: ${ex.type} · 3–4 підходи · 8–12 повторень · відпочинок 60–90 сек`;
        left.appendChild(name); left.appendChild(meta);

        const right = document.createElement('div');
        if(w){
          const wt = document.createElement('div'); wt.className='ex-weight'; wt.textContent = `${w} кг`;
          const range = document.createElement('div'); range.className='small'; range.style.textAlign='right'; range.textContent = `Діапазон: ±7%`;
          right.appendChild(wt); right.appendChild(range);
        } else {
          const note = document.createElement('div'); note.className='small'; note.textContent = 'Ця вправа — кардіо / вага тіла'; right.appendChild(note);
        }

        exEl.appendChild(left); exEl.appendChild(right);
        inner.appendChild(exEl);
      });

      container.appendChild(dayBlock);

      // staggered reveal
      setTimeout(()=> dayBlock.classList.add('visible'), 30 * d);
    }

    // recommendations
    const rec = document.createElement('div'); rec.className='recommendations';
    rec.innerHTML = '<strong>Рекомендації</strong><ul class="small"><li>Сон 7–9 годин.</li><li>Пийте 2–2.5 л води/день.</li><li>Білок 1.6–2.2 г/кг ваги (для набору м\'язів).</li><li>Прогресія: +2.5–5% ваги або +1–2 повтори щотижня при збереженні форми.</li><li>Розминка 5–10 хв; зупиніться при гострому болю.</li></ul>';
    container.appendChild(rec);
  }

  // ---------- Tabs behavior ----------
  function initTabs(){
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(t => t.addEventListener('click', () => {
      tabs.forEach(x => { x.classList.remove('active'); x.setAttribute('aria-selected','false'); });
      t.classList.add('active'); t.setAttribute('aria-selected','true');
      const tab = t.dataset.tab;
      const plan = q('planView'); const timer = q('timerView');
      if(tab === 'plan'){ plan.style.display = 'grid'; timer.style.display = 'none'; }
      else { plan.style.display = 'none'; timer.style.display = 'block'; }
      // micro animation: focus target
      const target = tab==='plan' ? plan : timer;
      target.animate([{opacity:0, transform:'translateY(8px)'},{opacity:1, transform:'none'}], {duration:320, easing:'cubic-bezier(.2,.9,.2,1)'});
    }));
  }

  // ---------- Events ----------
  q('gen').addEventListener('click', () => {
    const inputs = getInputs();
    // basic validation
    if(inputs.weight<=0 || inputs.height<=0){
      q('result').innerHTML = '<div class="small" style="color:var(--neon-2)">Вкажіть коректні значення ваги і зросту, будь ласка.</div>';
      return;
    }
    renderPlan();
  });

  // init
  initTabs();

  // ---------- Timer: improved stopwatch & countdown with WebAudio beep ----------
  (function timers(){
    // Stopwatch
    let swStarted = false, swStartTs = 0, swElapsed = 0, swTimerId = null;
    const swDisplay = q('stopwatchDisplay');

    function swRender(){
      const ms = swElapsed;
      const totalSec = Math.floor(ms/1000);
      const h = Math.floor(totalSec/3600); const m = Math.floor((totalSec%3600)/60); const s = totalSec%60;
      const tenth = Math.floor((ms%1000)/100);
      swDisplay.textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}.${tenth}`;
    }

    function swTick(){
      swElapsed = Date.now() - swStartTs;
      swRender();
    }

    q('swStart').addEventListener('click', ()=>{
      if(swStarted) return; swStarted = true; swStartTs = Date.now() - swElapsed; swTimerId = setInterval(swTick, 100); q('swStart').classList.add('pulse');
    });
    q('swStop').addEventListener('click', ()=>{ if(swStarted){ clearInterval(swTimerId); swTimerId=null; swStarted=false; q('swStart').classList.remove('pulse'); }});
    q('swReset').addEventListener('click', ()=>{ clearInterval(swTimerId); swTimerId=null; swStarted=false; swElapsed=0; swRender(); q('swStart').classList.remove('pulse'); });
    swRender();

    // Countdown
    let cdRemaining = 0, cdTimerId = null; const cdDisp = q('countdownDisplay'); const cdIn = q('countdownInput');
    function formatCountdown(sec){ const m=Math.floor(sec/60); const s=sec%60; return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`; }

    // lightweight beep using WebAudio API
    function beep(){ try{ const ctx = new (window.AudioContext||window.webkitAudioContext)(); const o = ctx.createOscillator(); const g = ctx.createGain(); o.type='sine'; o.frequency.value=880; g.gain.value=0.05; o.connect(g); g.connect(ctx.destination); o.start(); o.stop(ctx.currentTime + 0.15); }catch(e){}
    }

    q('cdStart').addEventListener('click', ()=>{
      const secs = parseInt(cdIn.value,10);
      if(isNaN(secs) || secs<=0){ alert('Вкажіть кількість секунд більше 0'); return; }
      cdRemaining = secs; cdDisp.textContent = formatCountdown(cdRemaining);
      if(cdTimerId) clearInterval(cdTimerId);
      cdTimerId = setInterval(()=>{ cdRemaining--; if(cdRemaining<=0){ clearInterval(cdTimerId); cdTimerId=null; cdDisp.textContent='00:00'; beep(); alert('Час вичерпано'); } else { cdDisp.textContent = formatCountdown(cdRemaining); } }, 1000);
      q('cdStart').classList.add('pulse');
    });
    q('cdPause').addEventListener('click', ()=>{ if(cdTimerId){ clearInterval(cdTimerId); cdTimerId=null; q('cdStart').classList.remove('pulse'); } });
    q('cdReset').addEventListener('click', ()=>{ if(cdTimerId){ clearInterval(cdTimerId); cdTimerId=null; } cdRemaining=0; cdDisp.textContent='00:00'; cdIn.value=''; q('cdStart').classList.remove('pulse'); });

  })();

})();
</script>
</body>
</html>
